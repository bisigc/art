<div ng-controller="SmellController as smellCtrl">
    <div class="page-header">
        <h1>Smell Browser <small>Subtext for header</small></h1>
    </div>
    <div class="well">
        <p>
            <a class="btn btn-primary" ng-class="{ active:smellCtrl.formvisible}" href role="button" ng-click="smellCtrl.showForm(!smellCtrl.formvisible)">Add Smell &raquo;</a>
        </p>
        <div ng-show="smellCtrl.formvisible">
            <form name="smellForm" ng-submit="smellForm.$valid && saveSmell()" novalidate>
                <div class="row">
                    <div class="col-md-7">
                        <fieldset class="form-group">
                            <label for="name">Name</label>
                            <input class="form-control" placeholder="Name of the Smell..." title="name" id="name" ng-model="smell.name" required></input>
                        </fieldset>
                    <fieldset class="form-group">
                        <label for="description">Description</label>
                        <textarea class="form-control" placeholder="Description of the Smell..." title="description" id="description" ng-model="smell.description" required></textarea>
                    </fieldset>
                    <fieldset class="form-group">
                        <label for="keywords">Keywords</label>
                        <input class="form-control" placeholder="Keywords to search for a Smell..." title="keywords" id="keywords" ng-model="smell.keywords" required></input>
                    </fieldset>
                </div>
                <div class="col-md-5">
                    <fieldset class="form-group">
                        <label for="group">Group</label>
                        <!-- select ui-select2 class="form-control" ng-model="" ng-options="group.id as group.name for group in smellCtrl.groups" title="group" id="group" required></select -->
                        <ui-select ng-model="smell.group_id" theme="selectize" ng-disabled="disabled" required>
                            <ui-select-match placeholder="Select or search a group in the list...">{{$select.selected.name}}</ui-select-match>
                            <ui-select-choices repeat="group in groups | filter: $select.search">
                                <span ng-bind-html="group.name | highlight: $select.search"></span>
                                <!-- small ng-bind-html="country.code | highlight: $select.search"></small -->
                            </ui-select-choices>
                        </ui-select>
                    </fieldset>
                    <fieldset class="form-group">
                        <label>Technical Debt Risk Index</label>
                        <table class="idxtable">
                            <tr>
                                <td id="problabel" class="problabel" rowspan="3">Probability</td>
                                <td>h&nbsp;</td>
                                <td ng-repeat="n in ['lh','mh','hh']">
                                    <label class="btn btn-default dbt-idx-{{n}}">
                                        <input type="radio" name="tecdebtidx" ng-model="smell.tecdebtidx" ng-value="n" required/>
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>m&nbsp;</td>
                                <td ng-repeat="n in ['lm','mm','hm']">
                                    <label class="btn btn-default dbt-idx-{{n}}">
                                        <input type="radio" name="tecdebtidx" ng-model="smell.tecdebtidx" ng-value="n" required/>
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>l&nbsp;</td>
                                <td ng-repeat="n in ['ll','ml','hl']">
                                    <label class="btn btn-default dbt-idx-{{n}}">
                                        <input type="radio" name="tecdebtidx" ng-model="smell.tecdebtidx" ng-value="n" required/>
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td ng-repeat="n in ['l','m','h']">{{n}}</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td class="implabel" colspan="3">Impact</td>
                            </tr>
                        </table>
                        <!-- select class="form-control" ng-model="smellCtrl.smell.tecdebtidx" ng-options="group.id as group.name for group in smellCtrl.groups" title="tecdebtidx" id="tecdebtidx" required></select -->
                    </fieldset>
                </div>
            </div>
            <fieldset class="form-group">
                <button type="submit" class="btn btn-primary pull-right" ng-disabled="smellForm.$invalid">Save Smell</button>
            </fieldset>
            </form>
        </div>
    </div>
    <div>
        <table id="searchObjResults" class="table table-striped table-hover non-select">
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Weight</th>
                <th>Group</th>
                <th>TecDebtIdx</th>
                <th></th>
            </tr>
            <tr>
                <td><input ng-model="search.name" placeholder="Enter search criteria" /></td>
                <td><input ng-model="search.description" placeholder="Enter search criteria" /></td>
                <td><input ng-model="search.weight" placeholder="Enter search criteria" /></td>
                <td><input ng-model="search.group_id" placeholder="Enter search criteria" /></td>
                <td><input ng-model="search.tecdebtidx" placeholder="Enter search criteria" /></td>
                <td></td>
            </tr>
            <tr>
                <th><a href ng-click="rname=!rname;order('name', rname)">Name <span ng-show="rname">&#x25B2;</span><span ng-show="!rname">&#x25BC;</span></a></th>
                <th><a href ng-click="rdesc=!rdesc;order('description', rdesc)">Description <span ng-show="rdesc">&#x25B2;</span><span ng-show="!rdesc">&#x25BC;</span></a></th>
                <th><a href ng-click="rweight=!rweight;order('weight', rweight)">Weight <span ng-show="rweight">&#x25B2;</span><span ng-show="!rweight">&#x25BC;</span></a></th>
                <th><a href ng-click="rgroup=!rgroup;order('group_id', rgroup)">Group <span ng-show="rgroup">&#x25B2;</span><span ng-show="!rgroup">&#x25BC;</span></a></th>
                <th><a href ng-click="rdebtidx=!rdebtidx;order('tecdebtidx', rdebtidx)">TecDebtIdx <span ng-show="rdebtidx">&#x25B2;</span><span ng-show="!rdebtidx">&#x25BC;</span></a></th>
                <th></th>
            </tr>
            <tr ng-show="smellCtrl.formvisible">
                <td>{{smell.name}}&nbsp;</td>
                <td>{{smell.description}}</td>
                <td>{{smell.weight}}</td>
                <td>{{groups[smell.group_id.id - 1].name}}</td>
                <td class="dbt-idx-{{smell.tecdebtidx}}">{{smell.tecdebtidx}}</td>
                <td></td>
            </tr>
            <tr ng-repeat="smellItem in smelllist | filter:search" ng-dblclick="openSmell(smellItem.id)">
                <td>{{smellItem.name}}</td>
                <td ng-bind-html="smellItem.description | limitHtml: 30"></td>
                <td>{{smellItem.weight}}</td>
                <td>{{groups[smellItem.group_id.id - 1].name}}</td>
                <td class="dbt-idx-{{smellItem.tecdebtidx}}">{{smellItem.tecdebtidx}}</td>
                <td><a href ng-click="openSmell(smellItem.id)"><span class="glyphicon glyphicon-pencil"></span></a>&nbsp;<a href ng-click="deleteSmell(smellItem.id)"><span class="glyphicon glyphicon-trash"></span></a></td>
            </tr>
        </table>
        <pagination total-items="bigTotalItems" ng-model="bigCurrentPage" max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false" num-pages="numPages"></pagination>
    </div>
</div>